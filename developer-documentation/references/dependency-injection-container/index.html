<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="http://developers.backbee.com/developer-documentation/references/dependency-injection-container/">
        <link rel="shortcut icon" href="../../../img/favicon.ico">

        <title>Dependency Injection Container - The BackBee documentation</title>

        <link href="../../../css/gen.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-3459992-27', 'docs.backbee.com');
            ga('send', 'pageview');
        </script>
        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../../.."><img src="../../../img/logo-bb-docs.png" alt="The BackBee documentation" title="The BackBee documentation" height="28" style="vertical-align:bottom;" /> <b>Documentation</b></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../../..">Introduction</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getting started <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../requirements/">Requirements</a>
                        </li>
                    
                        <li >
                            <a href="../../installation/">Installation</a>
                        </li>
                    
                        <li >
                            <a href="../../architecture/">Architecture</a>
                        </li>
                    
                        <li >
                            <a href="../../configuration/">Configuration</a>
                        </li>
                    
                        <li >
                            <a href="../../project_architecture/">Project Architecture</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cookbook <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../cookbooks/create_bundle_administration/">Create bundle administration</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/create_new_commands/">Create new commands</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/create-new-templating-helpers/">Create new templating helpers</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/customize_error_pages/">Customize error pages</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/ease_debugging_with_profiler/">Ease debugging with the Web Profiler</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/use_swift_mailer_in_backbee/">Use Swift Mailer in BackBee</a>
                        </li>
                    
                        <li >
                            <a href="../../cookbooks/layout_creation/">Layout creation using LayoutBuilderBundle</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Components <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../../components/bundle/">Bundle</a>
                        </li>
                    
                        <li >
                            <a href="../../components/cache/">Cache</a>
                        </li>
                    
                        <li >
                            <a href="../../components/classcontent/">ClassContent</a>
                        </li>
                    
                        <li >
                            <a href="../../components/config/">Config</a>
                        </li>
                    
                        <li >
                            <a href="../../components/event_listener/">Event Listener</a>
                        </li>
                    
                        <li >
                            <a href="../../components/nested_node/">Nested Node</a>
                        </li>
                    
                        <li >
                            <a href="../../components/renderer/">Renderer</a>
                        </li>
                    
                        <li >
                            <a href="../../components/routing/">Routing</a>
                        </li>
                    
                        <li >
                            <a href="../../components/security/">Security</a>
                        </li>
                    
                        <li >
                            <a href="../../components/translation/">Translation</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../events/">Events</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Dependency Injection Container</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../events/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li class="disabled">
                    <a rel="prev" >
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/backbee/docs">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container" id="main-container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#dependency-injection-container">Dependency Injection Container</a></li>
        
            <li><a href="#basic-usage">Basic usage</a></li>
        
            <li><a href="#to-register-new-service-and-parameter">To register new service and parameter</a></li>
        
            <li><a href="#learning-more">Learning more</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">
                

<h1 id="dependency-injection-container">Dependency Injection Container</h1>
<p>The Dependency Injection Container (DIC) allows you to standardize and centralize the way objects are constructed. BackBee CMS relies on this container.</p>
<h2 id="basic-usage">Basic usage</h2>
<p>To get BackBee's service container, you can use the method <code>BackBee\BBApplication::getContainer()</code>. You can retrieve services and parameters by calling <code>::get()</code> and <code>::getParameter()</code> on <code>BackBee\DependencyInjection\Container</code>.</p>
<pre><code class="php"># __PROJECT_ROOT_DIR__/index.php
&lt;?php

require __DIR__ . '/vendor/autoload.php';

use BackBee\BBApplication;

$app = new BBApplication();

$container = $app-&gt;getContainer(); // returns application's dependency injection container

$container-&gt;get('classcontent.manager'); // returns an instance of BackBee\ClassContent\ClassContentManager

$container-&gt;getParameter('debug'); // returns true or false, depending on your configuration
</code></pre>

<p>You can see all parameters and services registered by BackBee by exploring every YAML files inside the <code>Config/services/</code> folder (or <code>vendor/backbee/backbee/Config/services/</code> if you're using BackBee Standard Edition).</p>
<h2 id="to-register-new-service-and-parameter">To register new service and parameter</h2>
<p>The easiest way for you to register a new service or a parameter inside BackBee's service container is to use configuration files. Even if XML and YAML formats are accepted, we highly recommend to use YAML for its readability and simplicity. To learn about YAML syntax at <a href="http://yaml.org/">its official website</a>.</p>
<p>The settings file must be named <code>services.yml</code> and be in one of these locations:</p>
<ul>
<li><code>__PROJECT_ROOT__/repository/Config/services.yml</code> (for BackBee Standard Edition)</li>
<li><code>__BUNDLE_ROOT__/Config/services.yml</code> (for any bundle)</li>
</ul>
<h3 id="register-a-parameter">Register a parameter</h3>
<p>To register a new parameter inside the container, you simply have to declare it inside <code>parameters</code> section:</p>
<pre><code class="yaml"># repository/Config/services.yml
parameters:
    name: world
    message: hello %name%!
</code></pre>

<p>Note that you can reference others parameters  with the <code>%%</code> syntax. In the example above, <code>%name%</code> will be replaced by <code>world</code>:</p>
<pre><code class="php"># __PROJECT_ROOT_DIR__/index.php
&lt;?php

require __DIR__ . '/vendor/autoload.php';

use BackBee\BBApplication;

$app = new BBApplication();

$container = $app-&gt;getContainer();

echo $container-&gt;getParameter('name'); // print &quot;world&quot;
echo $container-&gt;getParameter('message'); // print &quot;hello world!&quot;
</code></pre>

<h3 id="register-a-service">Register a service</h3>
<p>To add a new service inside the DIC, you have to use the <code>services</code> section to do so:</p>
<pre><code class="yaml"># repository/Config/services.yml
parameters:
    current_datetime.class: \DateTime

services:
    current_datetime:
        class: %current_datetime.class%
        arguments: [&quot;now&quot;]
</code></pre>

<p>According to the service <code>current_datetime</code> declaration above, the DIC will instantiate the service (<code>new \DateTime('now')</code>) and return it:</p>
<pre><code class="php"># __PROJECT_ROOT_DIR__/index.php
&lt;?php

require __DIR__ . '/vendor/autoload.php';

use BackBee\BBApplication;

$app = new BBApplication();

$app-&gt;getContainer()-&gt;get('current_datetime'); // return an instance of \DateTime
</code></pre>

<h3 id="inject-a-service-or-a-parameter-inside-a-service-constructor">Inject a service or a parameter inside a service constructor</h3>
<p>You can decide to inject a service and/or a parameter inside another service constructor by using the syntax <code>@__IDENTIFIER__</code>. To illustrate this, we will use the following <code>Foobar</code> class:</p>
<pre><code class="php">&lt;?php

class Foobar
{
    private $datetime;
    private $name;

    public function __construct(\DateTime $datetime, $name)
    {
        $this-&gt;datetime = $datetime;
        $this-&gt;name = $name;
    }
}
</code></pre>

<p>As you can see, the class <code>Foobar</code> expects an instance of <code>DateTime</code> as first parameter. So let's add the <code>foobar</code> service inside the service container by editing the <code>services.yml</code> file:</p>
<pre><code class="yaml"># repository/Config/services.yml
parameters:
    name: John Do
    current_datetime.class: \DateTime

services:
    current_datetime:
        class: %current_datetime.class%
        arguments: [&quot;now&quot;]

    foobar:
        class: \Foobar
        arguments: [&quot;@current_datetime&quot;, &quot;%name%&quot;]
</code></pre>

<p>Like we show it above, <code>@current_datetime</code> means that we inject an object as first parameter of <code>Foobar</code> constructor (<code>current_datetime</code> which is an instance of <code>DateTime</code> so everything is fine).</p>
<h2 id="learning-more">Learning more</h2>
<p>If you take a look at <code>BackBee\DependencyInjection\Container</code> API, you will notice that you can use <code>::set()</code> method to add new services to the service container. But for performances reasons, BackBee will dump and freeze its service container (including all services and parameters). It occurs on the <code>bbapplication.init</code> event so it happens very early (at the end of <code>BackBee\BBApplication::__construct</code>). It's not possible to add new service on a frozen container. That why we recommend you to use YAML configurations files to declare your services (in fact you can set new services on a frozen container but they must be declared as synthetic).</p>
<p>BackBee dependency injection container is based on Symfony DependencyInjection component. To learn more about synthetic services, services tags or services factories, we invite you to take a look at <a href="http://symfony.com/doc/2.7/components/dependency_injection/index.html">the official documentation</a>. Except to the "Compiling" and "Compiler Pass" features, everything else are availables.</p>
                <hr />
                <div class="contribution-message">
    <h2>Is something missing?</h2>
    <p>If you notice something we've missed or could be improved on, please follow <a href="https://github.com/backbee/docs/blob/master/README.md" target="_blank">this link</a> and submit a pull request to the BackBee documentation repository. Once we merge it, the changes will be immediately reflected on the website.</p>
</div>
            </div>
        </div>

    <footer>
        <hr>
        <p>Copyright &copy; 2014-2015, <a href="http://www.backbee.com">BackBee project</a>.</p>
        <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>

        <div class="footer-copyright">
            <div class="container">
                <ul class="row nav">
                    <li class="col-sm-6 col-xs-4"><a href=" http://www.lp-digital.fr/en/index.php" target="_blank"><img src="http://backbee.com/img/logo-lpdigital-bw.png" alt="Lp digital"></a></li>
                    <li class="col-sm-6 col-xs-8 text-align-right"><a href=" http://www.lp-digital.fr/en/solutions.php" target="_blank" class="btn btn-dimmed btn-sm">Our other solutions</a><!-- SocialTools -->
                        <div class="social-tool-wrapper">
                            <ul class="nav">
                                <li><a href="https://www.facebook.com/backbeeCMS" target="_blank"><i class="fa fa-facebook"></i><span class="visuallyhidden">Facebook</span></a></li>
                                <li><a href="https://twitter.com/Lpdigitalsystem" target="_blank"><i class="fa fa-twitter"></i><span class="visuallyhidden">Twitter</span></a></li>
                                <li><a href="https://plus.google.com/101416676508957143369/posts" target="_blank"><i class="fa fa-google-plus"></i><span class="visuallyhidden">Google +</span></a></li>
                                <li><a href="http://backbee.com/services/contact-us"><i class="fa fa-envelope"></i><span class="visuallyhidden">Contact Us</span></a></li>
                            </ul>
                        </div>
                        <!-- End SocialTools -->
                    </li>
                </ul>
            </div>
        </div>
    </footer>


        <script src="../../../js/jquery-1.10.2.min.js"></script>
        <script src="../../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../../js/highlight.pack.js"></script>
        <script src="../../../js/base.js"></script>
    </body>
</html>